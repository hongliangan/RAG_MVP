<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>RAG MVP - 结果展示</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="container py-5">
    <h1 class="mb-4">RAG MVP - 结果展示</h1>
    <div class="mb-3">
        <strong>文件名：</strong> {{ filename }}
    </div>
    <div class="mb-3">
        <strong>你的问题：</strong> {{ question }}
    </div>
    <div class="mb-3">
        <strong>最终答案：</strong>
        <div class="alert alert-info">{{ answer }}</div>
    </div>
    <div class="mb-4">
        <h4>RAG处理进度</h4>
        <div class="progress" style="height: 30px;">
            <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" style="width: 100%">
                全部完成
            </div>
        </div>
        <ul class="mt-3">
            <li>文档加载：共 <strong>{{ doc_chunks|length }}</strong> 段</li>
            <li>向量化：共 <strong>{{ embeddings|length }}</strong> 向量</li>
            <li>检索：共 <strong>{{ retrieved_chunks|length }}</strong> 段</li>
            <li>生成：<strong>{% if answer %}已完成{% else %}处理中...{% endif %}</strong></li>
        </ul>
    </div>
    <button class="btn btn-link" type="button" data-bs-toggle="collapse" data-bs-target="#details" aria-expanded="false" aria-controls="details">
        查看详细处理过程
    </button>
    <div class="collapse mt-3" id="details">
        <div class="card card-body">
            <h5>1. 文档加载（分段结果）</h5>
            <ol>
                {% for chunk in doc_chunks %}
                <li><pre>{{ chunk }}</pre></li>
                {% endfor %}
            </ol>
            <h5>2. 检索到的相关片段</h5>
            <ol>
                {% for chunk in retrieved_chunks %}
                <li><pre>{{ chunk }}</pre></li>
                {% endfor %}
            </ol>
        </div>
    </div>
    <a href="/" class="btn btn-secondary mt-4">返回首页</a>
</body>
</html>
